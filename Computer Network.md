### ISO/OSI 7层模型
1. 应用层
2. 表示层：交换信息的表示方式(编码、压缩)
3. 会话层：建立同步，有序传输数据  

资源子网-计算机系统↑
***
通信子网-联网而附加的通信设备↓

4. **传输层：单位：TCP报文段，UDP用户数据报-连接**  
5. **网络层：单位：分组流量控制、拥塞控制、差错控制-连接/无连接**
6. 数据链路层：单位帧，成帧、差错控制、流量控制
7. 物理层：单位：比特，作用：透明传输比特流

### 分层的优点
1. **各层之间是独立的。**
某一层并不需要知道它的下一层是如何实现的，而仅仅需要知道该层通过层间的接口（即界面）所提供的服务。由于每一层只实现一种相对独立的功能，因而可将一个难以处理的复杂问题分解为若干个较容易处理的更小一些的问题。这样，整个问题的复杂程度就下降了。
2. 灵活性好。
当任何一层发生变化时（例如由于技术的变化），只要层间接口关系保持不变，则在这层以上或以下各层均不受影响。此外，对某一层提供的服务还可进行修改。
3. 结构上可分割开
各层都可以采用最合适的技术来实现.
4. **易于实现和维护**
这种结构使得实现和调试一个庞大而又复杂的系统变得易于处理，因为整个的系统已被分解为若干个相对独立的子系统。
5. **能促进标准化工作**
因为每一层的功能及其所提供的服务都已有了精确的说明。

### TCP/IP五层网络模型及协议
1. 应用层  
FTP、DNS、SMTP、HTTP
2. 传输层  
TCP、UDP
3. 网络层（路由器）  
IP、ARP、ICMP
4. 数据链路层（网桥，交换机）  
HDLC、PPP、MAC
5. 物理层（中继器，集线器，网关）
IEEE 802.11

### 各层协议
- **地址解析协议（ARP）**：IP地址->MAC地址（同一局域网，不同局域网借助路由器）
- **网际控制报文协议（ICMP）**：主机或路由器报告差错和异常情况，比如分组长度>MTU，DF=1的情况
---
- **动态主机配置协议（DHCP）** 应用层：动态分配IP地址，C/S模式
- **距离向量路由算法（RIP算法）应用层**，UDP：结点将路由选择表（全部信息）**定期传送给相邻结点**
- **链路状态路由算法（OSPF算法） 网络层**：类似Dijkstra算法，将链路状态传播给其他所有结点（**洪泛法**），特点：快速收敛
- **域名系统（DNS）** 应用层，UDP，域名解析过程（域名<->IP地址）  
递归查询方式；递归与迭代结合（本地域名代替主机进行迭代查询）顺序：**根、顶级、权限、本地**
- **文件传输协议（FTP）** 应用层，TCP，客户机/服务器模型，21号端口（控制端口）20号端口（数据连接）
- **超文本传输协议（HTTP）**：应用层，TCP  
**顺序**：TCP连接、HTTP请求报文、HTTP响应报文、释放TCP连接  
**非持久连接**：每个对象单独建立TCP连接（每个对象2RTT）  
**持久连接**（HTTP/1.1）：流水线（默认）（所有对象1RTT）；非流水（每个对象1RTT）
- **电子邮件（SMTP）** 应用层，TCP  
发送方UA->（SMTP）发送端邮件服务器->（SMTP）接收端邮件服务器->（POP3）接收方UA

### TCP三次握手与四次握手
图示如下：

![TCP](https://github.com/SZUZOUXu/-/blob/main/image/TCP三次握手、四次握手.png)

**三次握手**：  
1. 客户端发送一个带有SYN = 1(synchronize同步)标志的数据包给服务端。
2. 服务端接收成功后，回传一个带有SYN = 1,ACK = 1(Acknowledge character确认)标志的数据包传递确认信息，表示我收到了。
3. 客户端再回传一个带有ACK = 1的数据包，表示我知道了，握手结束。

**四次握手**
1. 客户端发送一个FIN = 1，用来关闭客户端到服务端的数据传送，客户端进入**FIN_WAIT_1**状态；
2. **确认**：服务端收到FIN后，发送一个ACK = 1给客户端，服务端进入**CLOSE_WAIT**状态；
3. **释放**：服务端发送一个FIN = 1，ACK = 1用来关闭服务端到客户端的数据传送，服务端进入**LAST_ACK**状态；
4. 客户端收到FIN后，客户端t进入**TIME_WAIT**状态，接着发送一个ACK = 1给Server，服务端进入**CLOSED**状态，客户端在发生ACK后等待2MSL（最大报文段生存时间）进入**CLOSED**状态。

### 为什么TCP不采用两次握手
防止失效的连接请求报文段突然又传送到主机B，因而产生错误。  
**主机A发出的连接请求没有收到主机B的确认**，于是经过一段时间后，**主机A又重新向主机B发送连接请求**，且建立成功，顺利完成数据传输。而第一次的连接是**网络节点导致延迟**达到主机B，这样主机B同意连接，一直在等待主机A发送数据，导致主机B的资源浪费。

### TCP拥塞控制中，什么是慢开始、拥塞避免、快重传和快恢复算法？
流量控制：发送窗口取**rwnd（接收窗口）和cwnd（拥塞窗口）的最小值**；注意窗口的单位是B
- **慢开始算法**：cwnd=1，每经过一轮cwnd加倍（若2×cwnd > ssthresh，将cwnd置为ssthresh）
-	**拥塞避免算法**：cwnd>=ssthresh（阈值）时，cwnd每轮+1
-	**网络拥塞**：更新ssthresh为此时cwnd的一半，并慢开始
- **快重传**：3个冗余ACK表丢失，直接重传
-	**快恢复**：同理，三个冗余ACK表丢失，但不至于完全拥塞，因此cwnd不置为1，而是改为门限ssthresh，然后执行拥塞避免算法

慢开始(1开始)->拥塞避免(阈值开始)->网络拥塞->慢开始  
              ↓->超时->快重传->快恢复->拥塞避免

### 点击www.baidu.com发生了什么
1. DNS域名解析获取服务器的IP地址。（web获得server的IP）
2. 浏览器向服务器的IP的端口号发起TCP三次握手建立连接；（web<->server）
3. 浏览器向服务器发送**HTTP请求报文**；（web->server连接）
4. 服务器根据HTTP请求报文的参数找到请求的资源（server）
5. 服务器给浏览器发送**HTTP应答报文**，把资源返回给客户端；（web<-server）
6. 通过四次挥手释放TCP连接；（web<->server释放）

### TCP和UDP的异同点
相同点：都是运输层协议
不同点：
1. **TCP**：面向连接的、点对点的、 面向字节流的、 提供可靠交付的、全双工的。
2. **UDP**：无连接的、支持一对一&一对多&多对多的通信，面向报文的（不涉及报文段的拆分和重组问题），尽最大努力交付的，半双工的，首部短⼩（8字节）

### 滑动窗口协议（数据链路、传输层）
接收方告诉发送方在某一时刻能送多少包（称窗口尺寸）
- **停等协议**：发送窗口=1，接受窗口=1
- **后退N帧协议**（GBN）：累计确认，发送窗口>1，接受窗口=1；发送窗口<=2^n-1，若大于最大值无法分清新旧，如大小为2^n，全部重传
- **选择性重传**（SR）：接收方设置缓冲区暂存未按序到达的帧，怀疑帧出错发否定NAK帧给发送方，发送窗口>1，接受窗口>1，窗口大小为2^(n-1)，即一半

### IPV4 和IPV6
1. **地址空间大小**  
IPv4协议具有32位(4字节)地址长度；IPv6协议具有128位(16字节)地址长度。
2. **地址的表示方法**
IPv4地址：以十进制表示，共四组，用点连接；IPv6地址：以十六进制表示，共八组，用冒号连接。
3. **安全性**
IPv6的安全性更高，用户可以在网络层认证与加密数据并对 IP 报文进行校验。
4. **传输速度**
IPv6的路由表更小，聚合能力更强，提升了网络数据转发的效率。

### 网络中的主机通信流程
1. 在同一个局域网
主机A查看ARP表，检查是否有主机B的IP到MAC的映射
- 有，构造报文，将数据包传给交换机（目的IP、目的MAC为B的），交换机检查是否有主机B的MAC到端口的映射（无则广播进行学习）
- 主机A需要发送ARP请求以获得目的MAC，交换机进行广播，主机B回复ARP回复报文，之后相同
2. 不在同一个局域网
多一步查看有无路由器的IP到MAC的映射，若无则进行ARP请求。整个传输过程中，源ip与目的ip均没有变化，变化的是MAC地址

### 一个主机将两个端口接到网络上是否会提升吞吐量？为什么？
将一个主机连接到网络上的两个端口并不会显著提高其吞吐量。网络上的吞吐量取决于网络中的瓶颈，而不是主机连接的端口数量。  
当一个主机连接到网络上时，它会被**分配一个唯一的MAC地址和IP地址**，无论该主机连接了一个端口还是多个端口。因此，从网络的角度来看，它仍然只是一个单独的节点。

### HTTP和HTTPS
- HTTPS是HTTP协议的安全版本，HTTP协议的数据传输是明文的，是不安全的，HTTPS使用了SSL/TLS协议进行了加密处理。
- HTTP和HTTPS使用连接方式不同，默认端口也不一样，HTTP是80，HTTPS是443。

### 协议
- 语法：传输数据的格式
- 语义：**完成的功能**（控制信息、动作及应答）
- 同步：时序关系

### 服务和协议的区别
1. 协议向上一层**提供服务**  
本层的服务用户只能看见服务而无法看见下面的协议。
2. 协议是**水平的**，即协议是控制两个对等实体之间交换的帧、报文、分组的格式和意义的规则，实体利用协议来实现他们的服务定义。
3. 服务是**垂直的**,即服务是下层通过层间接口向上层提供的。上层使用下层所提供的服务必须通过与下层交换一些命令，这些命令在OSI中称为服务原语。  

### 奈奎斯特定理
- 数据传输速率：2Wlog2V（b/s）；W是带宽，2W指的是波特，V是多少种码元
- 奈氏准则未限制信息传输速率
### 香农定理
- 数据传输速率：Wlog2(1+S/N)（b/s）；W是带宽，S/N是信噪比；信噪比有数值表示和分贝表示(10log10(S/N)两种形式)
- 给出了信息传输速率的极限

### CSMA/CD协议（碰撞检测）
- **有线局域网，半双工通信，不可靠**
- 边发送边侦听，碰撞后**指数退避算法**
1. 取k=min[重传次数,10]-(k值不大于10)
2. [0,1,...2^k-1]取一个数r，退避时间：2t×r
3. 重传次数不超过16次
- t为单程传播时延，2t为争用期
### CSMA/CA协议（碰撞避免）
- **无线局域网，接受信号强度小，波动大，存在隐蔽站问题**
- 帧间间隔IFS:检测信道空闲，等待DIFS，发送RTS
- 发送站**没有收到确认帧ACK，重传，对正确的数据帧进行确认**
- 隐蔽站：**信道预约**，源站广播请求发送帧**RTS（预约）**，AP广播允许发送帧CTS（许可）

### 冲突域和广播域
冲突域：
- 【定义】在同一个冲突域中的**每一个节点都能收到所有被发送的帧**。简单的说就是同一时间内只能有**一台设备发送信息**的范围。
- 【分层】基于OSI的第一层(数据链路层)**物理层**
- 【设备】第二层设备能隔离冲突域，⽐如**Switch**。交换机能缩小冲突域的范围，**交换接的每一个端口就是一个冲突域**。

广播域：  
- 【定义】⽹络中能**接收任一设备发出的广播帧的所有设备**的集合。简单的说如果站点发出一个广播信号，所有能接收收到这个信号的设备范围称为一个广播域。
- 【分层】基于OSI的第二层(物理层) **数据链路层**
- 【设备】第三层设备才能隔离广播域，比如**Router**。**路由器能隔离广播域，其每一个端⼝就是一个广播域。**


